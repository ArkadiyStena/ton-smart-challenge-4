() recv_internal() {
}
(cell) dfs(int hash, slice root) impure {
    while (~ root.slice_refs_empty?()) {
        cell child = root~load_ref();
        if (hash == cell_hash(child)) {
            return child;
        }
        return dfs(hash, child.begin_parse());
    }
    return begin_cell().end_cell();
}

;; testable
(cell) find_branch_by_hash(int hash, cell tree) method_id {
    
    return dfs(hash, begin_cell().store_ref(tree).end_cell().begin_parse());
}